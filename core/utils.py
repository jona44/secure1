from urllib import request
from django.contrib.auth.models import Group
from district.models import SchoolHeadProfile
from student.models import  StudentProfile
from teacher.models import TeacherProfile
from customsettings.models import  SchoolAdminProfile, SchoolProfile


def get_user_school(user):
    # Check for user type and return the corresponding school attribute
    if user.groups.filter(name='student').exists():
        return StudentProfile.objects.get(student=user).school  # Use `student=user` and `school`
    
    elif user.groups.filter(name='teacher').exists():
        return TeacherProfile.objects.get(teacher=user).school
    
    elif user.groups.filter(name='school_admin').exists():
        return SchoolProfile.objects.get(school_admin=user).school  # Adjust to match the field in SchoolProfile
    
    elif user.groups.filter(name='school_head').exists() or user.groups.filter(name='school_head').exists():
        return SchoolHeadProfile.objects.get(admin=user).school  # Adjust for school_head/deputy_head
    else:
        return None
